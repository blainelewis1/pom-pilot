(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{227:function(e,t,n){e.exports=n(373)},232:function(e,t,n){},373:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(18),i=n.n(o),c=(n(232),n(64)),l=n(65),u=n(73),s=n(67),m=n(74),d=n(375),g=n(16),f=n(20),p=n(39),h=n(25),v=n(28),E=n(72),b=n(68),O=6e4,S=["alarm.mp3"];window.Notification&&"default"===window.Notification.permission&&window.Notification.requestPermission();var y="START_TIMER",j="SET_PURPOSE",w="SETUP_TIMER",C="TIMER_COMPLETE",k="NOTIFY",I="ADD_TO_CALENDAR",A="SET_POM_LENGTH",T="SET_BREAK_LENGTH",x="SET_NOTIFICATION",D="SET_TIMER_SOUND",L="SET_GOOGLE_CLIENT_ID",N="SET_GOOGLE_ENABLED",_="SET_GOOGLE_SIGNED_IN",P="SET_GOOGLE_CALENDAR",G="SET_COLOR",M="ENQUEUE_SNACKBAR",R="REMOVE_SNACKBAR";function B(){return{type:y}}function U(){return function(e,t){t().timer.completed||(e({type:C}),e(function(e,t){var n,a=t(),r=a.settings,o=r.notifications,i=r.timerSound,c=a.timer,l=c.notified,u=c.completedAt,s=Date.now()-u>10*O;l||s||(o&&window.Notification&&new Notification("Your time is up!",{requireInteraction:!0}).addEventListener("close",function(){n&&n.pause()}),i&&(n=new Audio(i)).play(),e({type:k}))}),e(me()))}}function W(e){return function(t,n){n().timer.startedAt&&Date.now()-n().timer.startedAt>n().settings.minTime&&(t({type:C}),t(me())),t({type:w,timerValues:e})}}function F(e){return{type:M,notification:Object(g.a)({key:(new Date).getTime()+Math.random()},e)}}function H(e){return{type:R,key:e}}var J={timer:{length:25*O,purpose:"",startedAt:null,completedAt:null,completed:!1,notified:!1,addedToCalendar:!1,type:"pom"},settings:{pomLengthInMinutes:25,breakLengthInMinutes:5,notifications:!0,timerSound:"/alarm.mp3",minTime:1*O,googleApiKey:"",googleClientId:"",googleEnabled:!0,googleSignedIn:!1,googleCalendar:"primary",colors:{pom:null,breaking:null,action:null}}};var K=Object(v.c)({timer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J.timer,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:var n=void 0;return e.length&&(n=Date.now()+e.length),Object(g.a)({},e,{startedAt:Date.now(),completedAt:n});case j:return Object(g.a)({},e,{purpose:t.value});case w:var a=Object(g.a)({},J.timer);return Object(g.a)({},a,t.timerValues);case k:return Object(g.a)({},e,{notified:!0});case I:return Object(g.a)({},e,{addedToCalendar:!0});case C:return n=e.completedAt||Date.now(),Object(g.a)({},e,{completed:!0,completedAt:n});default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J.settings,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return Object(g.a)({},e,{googleClientId:t.value});case A:return Object(g.a)({},e,{pomLengthInMinutes:t.value});case T:return Object(g.a)({},e,{breakLengthInMinutes:t.value});case x:return Object(g.a)({},e,{notifications:t.value});case D:return Object(g.a)({},e,{timerSound:t.value});case N:return Object(g.a)({},e,{googleEnabled:t.value});case _:return Object(g.a)({},e,{googleSignedIn:t.value});case P:return Object(g.a)({},e,{googleCalendar:t.value});case G:return Object(g.a)({},e,{colors:Object(g.a)({},e.colors,Object(b.a)({},t.colorType,t.value))});default:return e}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return[].concat(Object(E.a)(e),[Object(g.a)({},t.notification)]);case R:return e.filter(function(e){return e.key!==t.key});default:return e}}}),V=n(148),q=n.n(V),z=n(149),Y=function(){var e=localStorage.getItem("reduxState")?JSON.parse(localStorage.getItem("reduxState")):J;e.settings.googleSignedIn=!1;var t=Object(v.d)(K,e,Object(v.a)(q.a,z.a));return t.subscribe(function(){localStorage.setItem("reduxState",JSON.stringify(t.getState()))}),t}(),Q=n(5),$=n(38),X=n.n($),Z=n(21);function ee(){var e=Object(f.a)(["\n  width: 100%;\n  height: 100%;\n  border-radius: 5px;\n  background-color: ",";\n"]);return ee=function(){return e},e}var te=window.gapi,ne=Z.a.div(ee(),function(e){return e.color}),ae=["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],re="https://www.googleapis.com/auth/calendar";var oe=function(e){var t=Object(h.a)({},e),n=Object(a.useState)([]),o=Object(p.a)(n,2),i=o[0],c=o[1];return Object(a.useEffect)(function(){te.client.calendar.calendarList.list().getPromise().then(function(e){return Promise.resolve(e.result.items)}).then(function(e){return c(e)})},[]),r.a.createElement(Q.l,Object.assign({select:!0,label:"Calendar",margin:"normal",variant:"outlined",fullWidth:!0,disabled:0===i.length},t),i.map(function(e){var t=e.id,n=e.summary,a=e.primary;return r.a.createElement(Q.h,{key:t,value:a?"primary":t},n)}))},ie=function(e){var t=Object(h.a)({},e),n=Object(a.useState)([]),o=Object(p.a)(n,2),i=o[0],c=o[1];return Object(a.useEffect)(function(){te.client.calendar.colors.get({calendarId:Y.getState().settings.googleCalendar}).getPromise().then(function(e){return Object.keys(e.result.event).map(function(t){return{id:t,color:e.result.event[t].background}})}).then(function(e){return c(e)})},[]),r.a.createElement(Q.l,Object.assign({select:!0,margin:"normal",variant:"outlined",fullWidth:!0,disabled:0===i.length},t),i.map(function(e){var t=e.id,n=e.color;return r.a.createElement(Q.h,{key:t,value:t},r.a.createElement(ne,{color:n},"\xa0"))}))};function ce(){te.client.init(Object(g.a)({},{clientId:Object({NODE_ENV:"production",PUBLIC_URL:"/pom-pilot"}).REACT_APP_GOOGLE_CLIENT_ID||Y.getState().settings.googleClientId},{discoveryDocs:ae,scope:re})).then(function(){te.auth2.getAuthInstance().isSignedIn.listen(le),le(!!te.auth2&&te.auth2.getAuthInstance().isSignedIn.get())}).catch(function(e){le(!1,e)})}function le(e,t){e?Y.dispatch(F({message:"Signed into Google Calendar.",options:{variant:"success"}})):Y.dispatch(F({message:"Signed out of Google Calendar",options:{variant:"error",action:[r.a.createElement(Q.a,{key:"authorise",size:"small",onClick:ue},"AUTHORISE"),r.a.createElement(Q.f,{key:"close","aria-label":"Close",color:"inherit"},r.a.createElement(X.a,null))]}})),Y.dispatch({type:_,value:e})}function ue(){te.auth2.getAuthInstance().signIn()}function se(e){return e.setMilliseconds(0),e.toJSON()}function me(){return function(e,t){var n=t(),a=n.settings,r=a.googleEnabled,o=a.googleCalendar,i=a.colors,c=n.timer,l=c.purpose,u=c.startedAt,s=c.completedAt,m=c.addedToCalendar,d=c.type;if(!m){if(!r)return;e({type:I});try{te.client.calendar.events.insert({calendarId:o,resource:{summary:l,colorId:i[d],start:{dateTime:se(new Date(u))},end:{dateTime:se(new Date(s))}}}).getPromise().then(function(){e(F({message:"Successfully added to Google Calendar!",options:{variant:"success"}}))}).catch(function(e){console.log(e),Y.dispatch(F({message:"Something went wrong adding to Google Calendar.",options:{variant:"error"}}))})}catch(g){console.log(g),Y.dispatch(F({message:"Something went wrong adding to Google Calendar.",options:{variant:"error"}}))}}}}te.load("client:auth2",ce);var de=te,ge=n(153),fe=n.n(ge),pe=n(24),he=n(152),ve=n(374);function Ee(){var e=Object(f.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  display: inline-block;\n"]);return Ee=function(){return e},e}function be(){var e=Object(f.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n\n  max-width: 100%;\n  width: 600px;\n  padding: 30px;\n"]);return be=function(){return e},e}var Oe=Object(Z.a)(Q.j)(be()),Se=Z.a.div(Ee()),ye=function(e){var t=e.children,n=Object(he.a)(e,["children"]);return r.a.createElement(Q.i,n,r.a.createElement(Oe,null,r.a.createElement(Se,null,r.a.createElement(Q.f,{"aria-label":"Settings",component:ve.a,to:"/"},r.a.createElement(X.a,{color:"action"}))),t))};function je(){var e=Object(f.a)(["\n  margin-bottom: 15px !important;\n"]);return je=function(){return e},e}function we(){var e=Object(f.a)(["\n  margin-top: 20px;\n"]);return we=function(){return e},e}var Ce=Object(Z.a)(Q.n)(we()),ke=Object(Z.a)(Q.e)(je());function Ie(e){de.auth2.getAuthInstance().signIn()}function Ae(e){de.auth2.getAuthInstance().signOut()}var Te=Object(pe.b)(function(e){var t=e.settings,n=e.google;return Object(g.a)({},t,n)},{onSetBreakLength:function(e){return{type:T,value:e}},onSetPomLength:function(e){return{type:A,value:e}},onSetNotifications:function(e){return{type:x,value:e}},onSetTimerSound:function(e){return{type:D,value:e}},onSetGoogleClientId:function(e){return{type:L,value:e}},onSetGoogleEnabled:function(e){return{type:N,value:e}},onSetGoogleCalendar:function(e){return{type:P,value:e}},onSetColor:function(e,t){return{type:G,colorType:e,value:t}}})(function(e){var t=e.history,n=e.breakLengthInMinutes,a=e.pomLengthInMinutes,o=e.timerSound,i=e.notifications,c=e.googleClientId,l=e.googleEnabled,u=e.googleSignedIn,s=e.googleCalendar,m=e.colors,d=m.pom,g=m.breaking,f=m.action,p=e.onSetGoogleEnabled,h=e.onSetPomLength,v=e.onSetBreakLength,E=e.onSetNotifications,b=e.onSetTimerSound,O=e.onSetGoogleClientId,y=e.onSetGoogleCalendar,j=e.onSetColor;return r.a.createElement(ye,{open:!0,onClose:function(){return t.push("/")}},r.a.createElement(ke,{container:!0,spacing:8},r.a.createElement(ke,{item:!0,xs:12},r.a.createElement(Ce,{variant:"h6",gutterBottom:!0},"Google Calendar",r.a.createElement(Q.k,{variant:"outlined",checked:l,onChange:function(e){return p(e.target.checked)}})),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ke,{container:!0,spacing:8},r.a.createElement(ke,{item:!0,xs:11},r.a.createElement(Q.l,{variant:"outlined",value:c,onChange:function(e){return O(e.target.value)},label:"Client ID",fullWidth:!0})),r.a.createElement(ke,{item:!0,xs:1},r.a.createElement(Q.m,{title:"In order to use the google calendar integration you must generate your own client id. It should be restricted to just this URL. Setup should be for javascript in the browser, accessing user data."},r.a.createElement(Q.f,null,r.a.createElement(fe.a,null))))),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ke,{item:!0},r.a.createElement(oe,{value:s,onChange:function(e){return y(e.target.value)}})),r.a.createElement(ke,{container:!0,spacing:8},r.a.createElement(ke,{item:!0,md:4,xs:12},r.a.createElement(ie,{label:"Break Color",value:g,onChange:function(e){return j("breaking",e.target.value)}})),r.a.createElement(ke,{item:!0,md:4,xs:12},r.a.createElement(ie,{label:"Action Color",value:f,onChange:function(e){return j("action",e.target.value)}})),r.a.createElement(ke,{item:!0,md:4,xs:12},r.a.createElement(ie,{label:"Pom Color",value:d,onChange:function(e){return j("pom",e.target.value)}})))),r.a.createElement(ke,{item:!0,xs:12},u?r.a.createElement(Q.a,{color:"secondary",onClick:Ae},"Sign out"):r.a.createElement(Q.a,{color:"primary",onClick:Ie},"Authorise"),r.a.createElement(Q.a,{color:"secondary",target:"_blank",href:"https://console.developers.google.com/start/api?id=calendar"},"Generate client id")))),r.a.createElement(ke,{item:!0,xs:12},r.a.createElement(Ce,{variant:"h6",gutterBottom:!0},"Timer"),r.a.createElement(ke,{item:!0,md:6,xs:12},r.a.createElement(Q.l,{label:"Break Length",variant:"outlined",onChange:function(e){v(e.target.value)},value:n,InputProps:{endAdornment:r.a.createElement(Q.g,{position:"end"},"minutes")},type:"number",fullWidth:!0})),r.a.createElement(ke,{item:!0,md:6,xs:12},r.a.createElement(Q.l,{label:"Pom Length",variant:"outlined",onChange:function(e){h(e.target.value)},value:a,InputProps:{endAdornment:r.a.createElement(Q.g,{position:"end"},"minutes")},type:"number",fullWidth:!0})),r.a.createElement(ke,{item:!0},r.a.createElement(Q.l,{select:!0,label:"Select",value:o,onChange:function(e){b(e.target.value),new Audio(e.target.value).play()},margin:"normal",variant:"outlined",fullWidth:!0},r.a.createElement(Q.h,{value:""}),S.map(function(e){return r.a.createElement(Q.h,{key:e,value:e},e)}))),r.a.createElement(ke,{item:!0},r.a.createElement(Q.b,{error:"denied"===window.Notification.permission},r.a.createElement(Q.c,{control:r.a.createElement(Q.k,{variant:"outlined",checked:i,onChange:function(e){return E(e.target.checked)}}),label:"Notifications"}),"denied"===window.Notification.permission&&i&&r.a.createElement(Q.d,null,"Notifications are currently denied, you will have to reset them in the settings."))))))});function xe(){var e=Object(f.a)(['\n  & textarea {\n    color: rgba(0, 0, 0, 0.87);\n    font-size: 3.75rem;\n    font-family: "Roboto", "Helvetica", "Arial", sans-serif;\n    font-weight: 300;\n    line-height: 1;\n    letter-spacing: -0.00833em;\n    text-align: center;\n    padding-top: 6px;\n    padding-right: 0px;\n    padding-bottom: 7px;\n    padding-left: 0px;\n  }\n']);return xe=function(){return e},e}function De(){var e=Object(f.a)(["\n  margin-top: 30px;\n"]);return De=function(){return e},e}function Le(){var e=Object(f.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n\n  text-align: center;\n\n  max-width: 600px;\n  width: 100%;\n"]);return Le=function(){return e},e}var Ne=Z.a.div(Le()),_e=Z.a.div(De()),Pe=Object(Z.a)(Q.l)(xe());var Ge=Object(pe.b)(function(e){return e.timer},{onSetPurpose:function(e){return function(t,n){t({type:j,value:e}),n().timer.startedAt||t(B())}}})(function(e){var t=e.purpose,n=e.startedAt,o=e.completedAt,i=e.length,c=e.onSetPurpose,l=n&&o,u=Date.now()>=o,s=n&&!i,m=function(){var e=Object(a.useState)(!0),t=Object(p.a)(e,2),n=t[0],r=t[1];return function(){return r(!n)}}();!function(e,t){var n=Object(a.useRef)(),r=Object(a.useRef)();Object(a.useEffect)(function(){n.current=e}),Object(a.useEffect)(function(){if(null!==t){r.current=Date.now();var e=setInterval(function(){var e=Date.now();n.current(e-r.current),r.current=e},t);return function(){return clearInterval(e)}}},[t])}(function(){return m()},l&&!u||s?100:null);var d,g=Object(a.useState)(t),f=Object(p.a)(g,2),h=f[0],v=f[1];Object(a.useEffect)(function(){return v(t)},[t]),d=l?o-Date.now():s?Date.now()-n:i,d=Math.max(0,d);var E=Math.floor(d/O),b=Math.floor(d%O/1e3),S="".concat(E,":").concat(b.toString().padStart(2,"0"));return document.title="(".concat(S,") ").concat(t," | Pom Pilot"),r.a.createElement(Ne,null,r.a.createElement(Q.n,{variant:"h1"},S),r.a.createElement(_e,null,t?r.a.createElement(Q.n,{variant:"h2"},t):r.a.createElement(Pe,{autoFocus:!0,fullWidth:!0,multiline:!0,placeholder:"What are you doing?",onChange:function(e){v(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),c(h))},value:h})))});function Me(){var e=Object(f.a)(["\n  position: fixed;\n  bottom: 0%;\n  left: 50%;\n  transform: translate(-50%, -100%);\n"]);return Me=function(){return e},e}var Re=Z.a.div(Me()),Be=Object(pe.b)(null,{onStartPom:function(){return function(e,t){e(W({startedAt:null,type:"pom",length:t().settings.pomLengthInMinutes*O}))}},onStartBreak:function(){return function(e,t){e(W({startedAt:Date.now(),type:"breaking",length:t().settings.breakLengthInMinutes*O,purpose:"Break"})),e(B())}},onStartAction:function(){return function(e){e(W({startedAt:Date.now(),length:0,type:"action"}))}}})(function(e){var t=e.onStartPom,n=e.onStartBreak,a=e.onStartAction;return r.a.createElement(Re,null,r.a.createElement(Q.a,{onClick:t},"Pom"),r.a.createElement(Q.a,{onClick:a},"Action"),r.a.createElement(Q.a,{onClick:n},"Break"))}),Ue=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ge,null),r.a.createElement(Be,null))},We=n(70),Fe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).displayed=[],n.storeDisplayed=function(e){n.displayed=[].concat(Object(E.a)(n.displayed),[e])},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e){for(var t=e.notifications,n=void 0===t?[]:t,a=this.props.notifications,r=!1,o=function(e){if(r)return"continue";r=r||!a.filter(function(t){var a=t.key;return n[e].key===a}).length},i=0;i<n.length;i+=1)o(i);return r}},{key:"componentDidUpdate",value:function(){var e=this,t=this.props.notifications;(void 0===t?[]:t).forEach(function(t){e.displayed.includes(t.key)||(e.props.enqueueSnackbar(t.message,t.options),e.storeDisplayed(t.key),e.props.removeSnackbar(t.key))})}},{key:"render",value:function(){return null}}]),t}(r.a.Component),He=Object(pe.b)(function(e){return{notifications:e.notifications}},function(e){return Object(v.b)({removeSnackbar:H},e)})(Object(We.withSnackbar)(Fe)),Je=n(154),Ke=n.n(Je),Ve=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se,null,r.a.createElement(Q.f,{"aria-label":"Settings",component:ve.a,to:"/settings"},r.a.createElement(Ke.a,{color:"action"}))),r.a.createElement(d.a,{path:"/",component:Ue}),r.a.createElement(d.a,{path:"/settings",component:Te}),r.a.createElement(He,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var qe=n(23),ze=n(376);function Ye(){Y.getState(),Y.getState().timer.length&&Y.getState().timer.startedAt&&Date.now()>=Y.getState().timer.completedAt&&!Y.getState().timer.completed&&Y.dispatch(U())}var Qe=n(104),$e=n.n(Qe),Xe=n(156),Ze=n.n(Xe),et=Object(qe.createMuiTheme)({typography:{useNextVariants:!0},palette:{primary:$e.a,secondary:Ze.a}});setInterval(Ye,100),i.a.render(r.a.createElement(qe.MuiThemeProvider,{theme:et},r.a.createElement(pe.a,{store:Y},r.a.createElement(We.SnackbarProvider,{action:[r.a.createElement(Q.f,{key:"close","aria-label":"Close",color:"inherit"},r.a.createElement(X.a,null))],autoHideDuration:3e3},r.a.createElement(ze.a,null,r.a.createElement(Ve,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[227,1,2]]]);
//# sourceMappingURL=main.fdefd1ef.chunk.js.map